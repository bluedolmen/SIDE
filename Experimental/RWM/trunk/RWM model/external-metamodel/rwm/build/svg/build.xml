<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     16 oct. 08 10:37:04                                                        

     DocBook generation to PDF    
                   
     bch                                                                
     ====================================================================== -->
<project name="DocBook generation" default="default">

	<taskdef resource="net/sf/antcontrib/antcontrib.properties" />

	<!-- ================================= 
          target: default              
         ================================= -->
	<target name="default">
		<antcall target="generatePictures" />
	</target>

	<target name="generatePictures">
		<foreach target="generatePicture" param="file">
			<path>
				<fileset dir="${generated_dir}" includes="*.svg" />
			</path>
		</foreach>
	</target>

	<target name="generatePicture">
		<echo>${file}</echo>
		<exec executable="inkscape" failifexecutionfails="false" resultproperty="error_conversion">
			<arg line="--without-gui --export-png='${file}.png' '${file}'" />
		</exec>
		<if>
			<equals arg1="${error_conversion}" arg2="0"/>
			<then>
				<delete file="${file}" />
			</then>
			<else>
				<exec executable="sh" failifexecutionfails="false" resultproperty="error_conversion">
					<arg line="build.sh '${file}' '${file}.png'" />
				</exec>
				<if>
					<equals arg1="${error_conversion}" arg2="0"/>
					<then>
						<delete file="${file}" />
					</then>
				</if>
			</else>
		</if>
	</target>

</project>